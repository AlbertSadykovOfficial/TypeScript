# Декларация типа

Декларация типа - файл с расширением .d.ts.
Наряду с JSDoc является способом приклрепления типов к
JS коду.

Синтаксис декларации типов (d.ts) похож на обычные файлы (.ts),
но несколько отличается:
1. Содержит только типы (без значений, т.е. без переменных, значений
по умолчанию, реализаций функций и классов (только имена))
2. Не определяют значения, но смотрят где и чем в коде была переменная,
на основе этого - дают ей набор типов (ИЛИ).
3. Объявляют типы только для того, что видно потрибителям (без 
неимпортируемых модулей, локальных переменных внутри тел функций) 

Запуск декларации типов:
```bash
tsc -d File.ts
```

Для чего файлы декларации типов:
1. Поиск локальных объявлений для именного нашего проекта
2. Редакторы кода с поддержкой TypeScript считывают файлы .d.ts, чтобы 
предостаить пользователям полезные подсказки.
3. Для ускорения процесса компиляции (т.к. избегают необязательных пе-
рекомпиляций кода TypeScript)

Сторонняя деклрарация - декларация типов (с помощью declare).
Регулярная декларация - декларация значений (с помощью let и const).

Использование деклорации типов помогает:
1. Сообщить TypeScript о глобальной переменной, которая определна где-то в JS.
2. Определить тип, доступный глобально по всему проекту (чтобы не импортировать)
3. Сторонняя декларация модуля (сообщить TS о модуле, установаленном с NPM).

## Различные виды деклараций

### Внешние декларации переменных
Способ сообщить о глобальной переменной, которая может быть использована
в файлах .d.ts. проекта без необходимости ее явного импорта.

К примеру, при создании файла и определения глобальных переменных в его
корне (что является присвоение в объект window), TS выдаст ошибку, что 
имя (proccess) нельзя найти
```typescript
// Error: невозможно найти имя process
process = {
	env: {
		NODE_ENV: 'production'
	}
}
```
Чтобы избежать этого, нужно для начала типизировать этот объект:
Тут мы объявляем TypeScript, что существует глобальный объект process, у которого
есть свойство env, имеющее свойства NODE_ENV (тогда TS это схавает).
```typescript
declare let process: {
	env: {
		NODE_ENV: 'development' | 'production'
	}
}

process = {
	env: {
		NODE_ENV: 'production'
	}
}
```

### Внешние декларации типов (Глобальные типы)

Следуют тем же правилам, что и декларация переменных

Поместив следующий код в файл index.d.ts,
Тип ToArray станет глобальным

```typescript
type ToArray<T> = T extends unknown[] ? T : T[]
```

### Внешние декларации модулей

Внешние декларации модулей - это регулярная декларация модулей,
окруженная особым синтаксисом declare module:
```typescript
declare module 'module-name' {
	export type MyType = number
	export type MyDefaultType = {a: string}
	export let myExport: MyType
	let myDefaultExport: MyDefaultType
	export default myDefaultExport
}

// Если вложенный модуль
declare module '@most/core' {
	// Декларация тип
}

// Все импорты будут имеють тип any
// Это может помочь импортировать js библиотеку код в ts
// (Чтоб ts не ругался)
declare module 'unsafe-module-name' 
```
Импорт
```typescript
import ModuleName from 'module-name'
ModuleName.a // string
```

### Создание зуглушек для модулей, не имеющих типов
(Белый список для модулей)

Для этого следует созать файл index.d.ts и перечислить там
все пакеты без типов, это хороший подход, чем игнорировать
в отдельных файлах, так как можно видеть все такие модули
в одном месте
```typescript
// Все импорты будут имеють тип any
// Это может помочь импортировать js библиотеку код в ts
// (Чтоб ts не ругался)
declare module 'unsafe-module-name'
```
